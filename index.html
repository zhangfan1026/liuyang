<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ç”Ÿæ—¥å¿«ä¹ ğŸ‚</title>
  <style>
    :root {
      --bg1: #ffecd2;
      --bg2: #fcb69f;
      --pink: #ff4081;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Microsoft YaHei", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background: linear-gradient(120deg, var(--bg1), var(--bg2));
      overflow-x: hidden;
      text-align: center;
    }

    /* ===== Intro Dialog ===== */
    #overlay {
      position: fixed; inset: 0; display: flex; align-items: center; justify-content: center;
      background: rgba(0,0,0,.55); z-index: 9999;
      animation: fadeIn .35s ease;
    }
    @keyframes fadeIn { from { opacity: 0 } to { opacity: 1 } }
    .dialog {
      width: min(92vw, 420px);
      background: #fff; border-radius: 16px; padding: 26px 22px;
      box-shadow: 0 18px 60px rgba(0,0,0,.25);
      transform: scale(.96); animation: pop .35s ease forwards;
    }
    @keyframes pop { to { transform: scale(1) } }
    .dialog h2 { margin: 0 0 12px; color: var(--pink); font-size: 24px; }
    .dialog p { margin: 0 0 18px; color: #666; font-size: 14px; }
    .btnrow { display: flex; gap: 12px; justify-content: center; }

    .btn {
      appearance: none; border: 0; cursor: pointer;
      padding: 12px 20px; border-radius: 999px; font-size: 16px;
      transition: transform .22s ease, box-shadow .22s ease, background .22s ease;
      box-shadow: 0 6px 14px rgba(0,0,0,.15);
      will-change: transform;
    }
    .yes { background: var(--pink); color: #fff; }
    .no  { background: #87ceeb; color: #fff; }

    /* å›ºå®šçš„ä¸‰ç§å°ºå¯¸ï¼Œé˜²æ­¢ç´¯è®¡ç¼©æ”¾ */
    .scale-100 { transform: scale(1); }
    .scale-big  { transform: scale(1.35); }
    .scale-small{ transform: scale(0.82); }

    /* ===== Main Content ===== */
    main { opacity: 0; pointer-events: none; transition: opacity .35s ease; min-height: 100vh; }
    main.active { opacity: 1; pointer-events: auto; }

    h1 {
      margin: 40px 0 8px;
      font-size: clamp(36px, 6vw, 56px);
      color: var(--pink);
      text-shadow: 2px 2px 10px rgba(0,0,0,.18);
      animation: bounce 1.5s infinite;
    }
    @keyframes bounce { 0%,100%{ transform: translateY(0) } 50%{ transform: translateY(-12px) } }

    #message { font-size: 22px; color: #333; min-height: 32px; margin-bottom: 12px; }

    /* Cake */
    #cake { width: 170px; height: 150px; background: #ffb6c1; border-radius: 12px; margin: 18px auto 0; position: relative;
      box-shadow: 0 12px 24px rgba(0,0,0,.18); animation: pulse 1.8s infinite; display: none; }
    @keyframes pulse { 0%,100%{ transform: scale(1) } 50%{ transform: scale(1.05) } }
    #cake::before{ content:""; position:absolute; top:-42px; left:50%; transform:translateX(-50%); width:22px; height:42px; background:#fff8dc; border-radius:6px; }
    #cake::after{ content:""; position:absolute; top:-56px; left:50%; transform:translateX(-50%); width:12px; height:22px; background:orange; border-radius:50%; box-shadow:0 0 14px 4px rgba(255,221,0,.9); animation:flicker .28s infinite; }
    @keyframes flicker { 0%,100%{ opacity:1 } 50%{ opacity:.5 } }

    /* Controls */
    .controls { display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin:22px 12px 36px; }
    .controls button { padding: 12px 20px; border:none; border-radius: 999px; background: var(--pink); color:#fff; font-size:16px; cursor:pointer; box-shadow:0 6px 14px rgba(0,0,0,.15); transition: transform .2s ease; }
    .controls button:hover { transform: translateY(-2px); }

    /* Balloons */
    .balloon { position: fixed; bottom: -140px; width: 54px; height: 72px; border-radius: 50%;
      animation: floatUp linear infinite; }
    @keyframes floatUp { from { transform: translateY(0) } to { transform: translateY(-115vh) } }

    /* Confetti */
    .confetti { position: fixed; top:-16px; width: 10px; height: 10px; background: red; animation: fall linear forwards; }
    @keyframes fall { from { transform: translateY(-8vh) rotate(0) } to { transform: translateY(110vh) rotate(360deg) } }

    /* Fireworks canvas */
    canvas { position: fixed; inset: 0; pointer-events: none; z-index: 0; }

    /* ===== Blessing Modal ===== */
    #blessing-modal {
      position: fixed; inset: 0; display: flex; align-items: center; justify-content: center;
      background: rgba(0,0,0,.6); z-index: 10000; display: none;
    }
    .blessing-content {
      width: min(90vw, 500px); background: #fff; padding: 30px; border-radius: 20px;
      box-shadow: 0 12px 40px rgba(0,0,0,.3); text-align: left;
      animation: popIn .35s ease;
    }
    @keyframes popIn { from { transform: scale(.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    .blessing-text {
      font-size: 24px; line-height: 1.6; color: #333; min-height: 100px; white-space: pre-wrap;
    }
    .cursor {
      display: inline-block; width: 2px; height: 1.2em; background-color: var(--pink);
      margin-left: 2px; animation: blink .7s infinite;
    }
    @keyframes blink { 50% { opacity: 0; } }
    .close-btn {
      position: absolute; top: 15px; right: 15px; background: none; border: none; font-size: 28px;
      color: #999; cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="overlay">
    <div class="dialog">
      <h2>ä»Šå¤©æ˜¯ä½ çš„ç”Ÿæ—¥å—ï¼ŸğŸ‚</h2>
      <p>å‡†å¤‡å¥½é¢†å–ä¸€å¤§æ³¢æƒŠå–œäº†å—ï½</p>
      <div class="btnrow">
        <button id="yesBtn" class="btn yes scale-100">å½“ç„¶æ˜¯ï¼</button>
        <button id="noBtn"  class="btn no  scale-100">å†ç­‰ç­‰</button>
      </div>
      <p id="tease" style="margin-top:10px;color:#777;min-height:1.2em"></p>
    </div>
  </div>

  <div id="blessing-modal">
    <div class="blessing-content">
      <button class="close-btn" onclick="closeBlessingModal()">&times;</button>
      <p class="blessing-text" id="typed-blessing"></p>
    </div>
  </div>

  <main id="main">
    <h1>ğŸ‰ ç”Ÿæ—¥å¿«ä¹ï¼ ğŸ‚</h1>
    <div id="message"></div>
    <div id="cake"></div>

    <div class="controls">
      <button onclick="playMusic()">â–¶ æ’­æ”¾éŸ³ä¹</button>
      <button onclick="showBlessingModal()">ğŸ é¢†å–ç¥ç¦</button>
      <button onclick="showCake()">ğŸ‚ çœ‹è›‹ç³•</button>
      <button onclick="releaseBalloons()">ğŸˆ æ”¾æ°”çƒ</button>
      <button onclick="throwConfetti()">ğŸ‰ æ’’å½©çº¸</button>
    </div>
  </main>

  <canvas id="fw"></canvas>
  <audio id="music" src="music.mp3" preload="auto" loop></audio>

  <script>
    // ===== Config =====
    const BLESSING_TEXT = "äº²çˆ±çš„æœ‹å‹ï¼Œç”Ÿæ—¥å¿«ä¹ï¼\n\næ„¿ä½ ä¸‡äº‹èƒœæ„ã€è¢«çˆ±ç¯ç»•ï½ ğŸ‚ğŸ‰\n\nç”Ÿæ´»å¯ä»¥äº”é¢œå…­è‰²ï¼Œæ„¿ä½ ç»§ç»­çƒ­çˆ±è¿™ä¸ªä¸–ç•Œï¼Œæ´»å‡ºè‡ªå·±çš„å…‰èŠ’ã€‚\n\nè€ƒç ”çš„è·¯ä¸Šä½ ä»˜å‡ºäº†æ— æ•°æ±—æ°´ä¸åšæŒï¼Œç°åœ¨ç»ˆäºè¿æ¥å†²åˆºä¸æ”¶è·çš„æ—¶åˆ»ã€‚æ„¿ä½ æ²‰ç€åº”è€ƒï¼Œç¬”ä¸‹ç”ŸèŠ±ï¼Œå¿ƒä¸­æ‰€å­¦å°½æƒ…å±•ç°ã€‚æ— è®ºè¿‡ç¨‹å¤šä¹ˆè‰°éš¾ï¼Œä½ çš„åŠªåŠ›éƒ½ä¸ä¼šè¢«è¾œè´Ÿã€‚ç¥ä½ é‡‘æ¦œé¢˜åï¼Œæ¢¦æƒ³ä¸Šå²¸ï¼Œå‰é€”ä¼¼é”¦ï¼ ğŸŒ¸ğŸ“šâœ¨\n\nè€é“åŠ æ²¹!ä¸€å®šèƒ½è€ƒä¸Šï¼Œç­‰ä½ å¥½æ¶ˆæ¯ï¼";";

    // ===== Elements =====
    const overlay = document.getElementById('overlay');
    const yesBtn = document.getElementById('yesBtn');
    const noBtn  = document.getElementById('noBtn');
    const tease  = document.getElementById('tease');
    const mainEl = document.getElementById('main');
    const messageEl = document.getElementById('message');
    const cakeEl = document.getElementById('cake');
    const music = document.getElementById('music');
    const blessingModal = document.getElementById('blessing-modal');
    const typedBlessingEl = document.getElementById('typed-blessing');

    // ===== Dialog interactions =====
    // state flips on each "å†ç­‰ç­‰" click to alternate which one is big/small
    let flipped = false;

    function setSizes(yesSize, noSize){
      // remove previous size classes
      [yesBtn, noBtn].forEach(btn => btn.classList.remove('scale-100','scale-big','scale-small'));
      yesBtn.classList.add(yesSize);
      noBtn.classList.add(noSize);
    }

    noBtn.addEventListener('click', () => {
      flipped = !flipped;
      // alternate big/small between the two buttons â€” NO cumulative scaling
      if (!flipped) {
        setSizes('scale-big','scale-small');
        tease.textContent = 'å˜¿ï¼Œå†çŠ¹è±«ä¸€ä¼šå„¿ä¹Ÿè¡Œï¼Œä¸è¿‡æƒŠå–œåœ¨ç­‰ä½ å“¦ï½';
      } else {
        setSizes('scale-small','scale-big');
        tease.textContent = 'å†ç­‰ç­‰ï¼Ÿé‚£æˆ‘å°±æŠŠæƒŠå–œå†æ”¾å¤§ä¸€ç‚¹ç‚¹~';
      }
    });

    yesBtn.addEventListener('click', () => {
      overlay.style.display = 'none';
      mainEl.classList.add('active');
      playMusic();
      // small entrance burst
      throwConfetti(60);
      releaseBalloons(12);
    });

    // ===== Music function =====
    function playMusic(){
      music.play().then(() => {
        // æˆåŠŸæ’­æ”¾
        console.log("éŸ³ä¹å·²å¼€å§‹æ’­æ”¾");
      }).catch(error => {
        // æ’­æ”¾å¤±è´¥ï¼Œé€šå¸¸æ˜¯å› ä¸ºæµè§ˆå™¨é˜»æ­¢äº†è‡ªåŠ¨æ’­æ”¾
        console.error("éŸ³ä¹æ’­æ”¾å¤±è´¥:", error);
        alert("éŸ³ä¹æ’­æ”¾å¤±è´¥ã€‚è¯·ç‚¹å‡»é¡µé¢ä¸Šçš„ä»»æ„ä½ç½®æ¥å°è¯•æ’­æ”¾éŸ³ä¹ã€‚");
      });
    }

    // ===== Blessing Modal Logic =====
    function showBlessingModal() {
      blessingModal.style.display = 'flex';
      typeWriter(BLESSING_TEXT, typedBlessingEl);
    }

    function closeBlessingModal() {
      blessingModal.style.display = 'none';
      typedBlessingEl.innerHTML = ''; // æ¸…ç©ºå†…å®¹ä»¥ä¾¿ä¸‹æ¬¡é‡æ–°æ‰“å­—
    }

    function typeWriter(text, element) {
      let i = 0;
      element.textContent = ''; // æ¸…ç©ºå†…å®¹
      const cursor = document.createElement('span');
      cursor.className = 'cursor';
      element.appendChild(cursor);

      const speed = 100; // æ‰“å­—é€Ÿåº¦ï¼Œæ¯«ç§’

      function type() {
        if (i < text.length) {
          if (text.charAt(i) === '\n') {
            element.insertBefore(document.createElement('br'), cursor);
          } else {
            const charSpan = document.createElement('span');
            charSpan.textContent = text.charAt(i);
            element.insertBefore(charSpan, cursor);
          }
          i++;
          setTimeout(type, speed);
        } else {
          // æ‰“å­—ç»“æŸåç§»é™¤å…‰æ ‡
          cursor.remove();
        }
      }
      type();
    }

    // ===== Other Controls logic =====
    function showCake(){ cakeEl.style.display = 'block'; }

    function releaseBalloons(count = 10){
      for (let i=0;i<count;i++){
        const b = document.createElement('div');
        b.className = 'balloon';
        b.style.left = Math.random()*100 + 'vw';
        b.style.background = `hsl(${Math.random()*360},70%,65%)`;
        b.style.animationDuration = (4+Math.random()*6)+'s';
        b.style.zIndex = 1;
        document.body.appendChild(b);
        setTimeout(()=>b.remove(), 12000);
      }
    }

    function throwConfetti(count = 36){
      for (let i=0;i<count;i++){
        const c = document.createElement('div');
        c.className = 'confetti';
        c.style.left = Math.random()*100 + 'vw';
        c.style.background = `hsl(${Math.random()*360},85%,60%)`;
        c.style.width = c.style.height = (6+Math.random()*10)+'px';
        c.style.animationDuration = (2+Math.random()*3)+'s';
        c.style.zIndex = 2;
        document.body.appendChild(c);
        setTimeout(()=>c.remove(), 6000);
      }
    }

    // ===== Fireworks on click (after entering) =====
    const fw = document.getElementById('fw');
    const ctx = fw.getContext('2d');
    function resize(){ fw.width = innerWidth; fw.height = innerHeight; }
    resize(); addEventListener('resize', resize);

    function firework(x, y){
      for (let i=0;i<50;i++){
        let px=x, py=y;
        const ang = Math.random()*Math.PI*2;
        const spd = 1 + Math.random()*4.5;
        const vx = Math.cos(ang)*spd;
        const vy = Math.sin(ang)*spd;
        const color = `hsl(${Math.random()*360},100%,60%)`;
        let life = 60;
        (function draw(){
          if (life-- > 0){
            ctx.fillStyle = color;
            ctx.fillRect(px, py, 2, 2);
            px += vx; py += vy; 
            // gravity
            py += 0.04;
            requestAnimationFrame(draw);
          }
        })();
      }
    }

    addEventListener('click', (e) => {
      if (overlay.style.display === 'none'){
        firework(e.clientX, e.clientY);
      }
    });
  </script>
</body>

</html>







